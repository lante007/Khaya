{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.222.0"},"children":{"KhayaStack":{"id":"KhayaStack","path":"KhayaStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.222.0"},"children":{"UsersTable":{"id":"UsersTable","path":"KhayaStack/UsersTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/UsersTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"id","attributeType":"S"},{"attributeName":"email","attributeType":"S"},{"attributeName":"phone","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"EmailIndex","keySchema":[{"attributeName":"email","keyType":"HASH"}],"projection":{"projectionType":"ALL"}},{"indexName":"PhoneIndex","keySchema":[{"attributeName":"phone","keyType":"HASH"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"id","keyType":"HASH"}],"pointInTimeRecoverySpecification":{"pointInTimeRecoveryEnabled":true},"streamSpecification":{"streamViewType":"NEW_AND_OLD_IMAGES"}}}},"ScalingRole":{"id":"ScalingRole","path":"KhayaStack/UsersTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}}}},"ProfilesTable":{"id":"ProfilesTable","path":"KhayaStack/ProfilesTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/ProfilesTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"userId","attributeType":"S"},{"attributeName":"location","attributeType":"S"},{"attributeName":"trustScore","attributeType":"N"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"LocationIndex","keySchema":[{"attributeName":"location","keyType":"HASH"},{"attributeName":"trustScore","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"userId","keyType":"HASH"}],"streamSpecification":{"streamViewType":"NEW_AND_OLD_IMAGES"}}}},"ScalingRole":{"id":"ScalingRole","path":"KhayaStack/ProfilesTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}}}},"JobsTable":{"id":"JobsTable","path":"KhayaStack/JobsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/JobsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"id","attributeType":"S"},{"attributeName":"createdAt","attributeType":"S"},{"attributeName":"status","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"StatusIndex","keySchema":[{"attributeName":"status","keyType":"HASH"},{"attributeName":"createdAt","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"id","keyType":"HASH"},{"attributeName":"createdAt","keyType":"RANGE"}],"streamSpecification":{"streamViewType":"NEW_AND_OLD_IMAGES"}}}},"ScalingRole":{"id":"ScalingRole","path":"KhayaStack/JobsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}}}},"BidsTable":{"id":"BidsTable","path":"KhayaStack/BidsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/BidsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"id","attributeType":"S"},{"attributeName":"jobId","attributeType":"S"},{"attributeName":"amount","attributeType":"N"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"JobIndex","keySchema":[{"attributeName":"jobId","keyType":"HASH"},{"attributeName":"amount","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"id","keyType":"HASH"},{"attributeName":"jobId","keyType":"RANGE"}]}}},"ScalingRole":{"id":"ScalingRole","path":"KhayaStack/BidsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}}}},"ListingsTable":{"id":"ListingsTable","path":"KhayaStack/ListingsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/ListingsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"id","attributeType":"S"},{"attributeName":"category","attributeType":"S"},{"attributeName":"createdAt","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"CategoryIndex","keySchema":[{"attributeName":"category","keyType":"HASH"},{"attributeName":"createdAt","keyType":"RANGE"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"id","keyType":"HASH"}]}}},"ScalingRole":{"id":"ScalingRole","path":"KhayaStack/ListingsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}}}},"ReviewsTable":{"id":"ReviewsTable","path":"KhayaStack/ReviewsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/ReviewsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"id","attributeType":"S"},{"attributeName":"reviewedId","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"id","keyType":"HASH"},{"attributeName":"reviewedId","keyType":"RANGE"}]}}},"ScalingRole":{"id":"ScalingRole","path":"KhayaStack/ReviewsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}}}},"CreditsTable":{"id":"CreditsTable","path":"KhayaStack/CreditsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/CreditsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"id","attributeType":"S"},{"attributeName":"userId","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"id","keyType":"HASH"},{"attributeName":"userId","keyType":"RANGE"}]}}},"ScalingRole":{"id":"ScalingRole","path":"KhayaStack/CreditsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}}}},"ReferralsTable":{"id":"ReferralsTable","path":"KhayaStack/ReferralsTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/ReferralsTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"id","attributeType":"S"},{"attributeName":"referralCode","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","globalSecondaryIndexes":[{"indexName":"CodeIndex","keySchema":[{"attributeName":"referralCode","keyType":"HASH"}],"projection":{"projectionType":"ALL"}}],"keySchema":[{"attributeName":"id","keyType":"HASH"}]}}},"ScalingRole":{"id":"ScalingRole","path":"KhayaStack/ReferralsTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}}}},"StoriesTable":{"id":"StoriesTable","path":"KhayaStack/StoriesTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/StoriesTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"id","attributeType":"S"},{"attributeName":"createdAt","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"id","keyType":"HASH"},{"attributeName":"createdAt","keyType":"RANGE"}]}}},"ScalingRole":{"id":"ScalingRole","path":"KhayaStack/StoriesTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}}}},"KhayaUserPool":{"id":"KhayaUserPool","path":"KhayaStack/KhayaUserPool","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPool","version":"2.222.0","metadata":[]},"children":{"smsRole":{"id":"smsRole","path":"KhayaStack/KhayaUserPool/smsRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.222.0","metadata":[]},"children":{"ImportsmsRole":{"id":"ImportsmsRole","path":"KhayaStack/KhayaUserPool/smsRole/ImportsmsRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}},"Resource":{"id":"Resource","path":"KhayaStack/KhayaUserPool/smsRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Condition":{"StringEquals":{"sts:ExternalId":"KhayaStackKhayaUserPool8AD7DA64"}},"Effect":"Allow","Principal":{"Service":"cognito-idp.amazonaws.com"}}],"Version":"2012-10-17"},"policies":[{"policyName":"sns-publish","policyDocument":{"Statement":[{"Action":"sns:Publish","Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"}}]}}}}},"Resource":{"id":"Resource","path":"KhayaStack/KhayaUserPool/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPool","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPool","aws:cdk:cloudformation:props":{"accountRecoverySetting":{"recoveryMechanisms":[{"name":"verified_phone_number","priority":1}]},"adminCreateUserConfig":{"allowAdminCreateUserOnly":false},"autoVerifiedAttributes":["phone_number"],"emailVerificationMessage":"The verification code to your new account is {####}","emailVerificationSubject":"Verify your new account","policies":{"passwordPolicy":{"minimumLength":8,"requireLowercase":true,"requireUppercase":false,"requireNumbers":true,"requireSymbols":false}},"schema":[{"name":"phone_number","mutable":true,"required":true},{"name":"email","mutable":true,"required":false},{"name":"role","attributeDataType":"String","stringAttributeConstraints":{"minLength":"1","maxLength":"20"},"mutable":true}],"smsConfiguration":{"externalId":"KhayaStackKhayaUserPool8AD7DA64","snsCallerArn":{"Fn::GetAtt":["KhayaUserPoolsmsRoleA7549BCE","Arn"]}},"smsVerificationMessage":"The verification code to your new account is {####}","usernameAttributes":["email","phone_number"],"verificationMessageTemplate":{"defaultEmailOption":"CONFIRM_WITH_CODE","emailMessage":"The verification code to your new account is {####}","emailSubject":"Verify your new account","smsMessage":"The verification code to your new account is {####}"}}}}}},"KhayaAppClient":{"id":"KhayaAppClient","path":"KhayaStack/KhayaAppClient","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.UserPoolClient","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/KhayaAppClient/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cognito.CfnUserPoolClient","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Cognito::UserPoolClient","aws:cdk:cloudformation:props":{"allowedOAuthFlows":["implicit","code"],"allowedOAuthFlowsUserPoolClient":true,"allowedOAuthScopes":["profile","phone","email","openid","aws.cognito.signin.user.admin"],"callbackUrLs":["https://example.com"],"explicitAuthFlows":["ALLOW_USER_PASSWORD_AUTH","ALLOW_USER_SRP_AUTH","ALLOW_REFRESH_TOKEN_AUTH"],"generateSecret":false,"supportedIdentityProviders":["COGNITO"],"userPoolId":{"Ref":"KhayaUserPool64146B1C"}}}}}},"KhayaStorageBucket":{"id":"KhayaStorageBucket","path":"KhayaStack/KhayaStorageBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/KhayaStorageBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"corsConfiguration":{"corsRules":[{"allowedHeaders":["*"],"allowedMethods":["GET","PUT","POST"],"allowedOrigins":["*"]}]}}}}}},"ApiLambda":{"id":"ApiLambda","path":"KhayaStack/ApiLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.222.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"KhayaStack/ApiLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.222.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"KhayaStack/ApiLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}},"Resource":{"id":"Resource","path":"KhayaStack/ApiLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"KhayaStack/ApiLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/ApiLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["UsersTable9725E9C8","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ProfilesTable3B48B4C6","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ProfilesTable3B48B4C6","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["JobsTable1970BC16","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["JobsTable1970BC16","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["BidsTableE1AD1632","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["BidsTableE1AD1632","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ListingsTableCCEBB5D2","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ListingsTableCCEBB5D2","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ReviewsTable1E51AE49","Arn"]},{"Ref":"AWS::NoValue"}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["CreditsTable13AC5EA8","Arn"]},{"Ref":"AWS::NoValue"}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ReferralsTable2A6E2E9C","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ReferralsTable2A6E2E9C","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["StoriesTableF145CECC","Arn"]},{"Ref":"AWS::NoValue"}]},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["KhayaStorageBucket6A5AFBEB","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["KhayaStorageBucket6A5AFBEB","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"ApiLambdaServiceRoleDefaultPolicyF1B57697","roles":[{"Ref":"ApiLambdaServiceRole1CC7D0F3"}]}}}}}}},"Code":{"id":"Code","path":"KhayaStack/ApiLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.222.0"},"children":{"Stage":{"id":"Stage","path":"KhayaStack/ApiLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.222.0"}},"AssetBucket":{"id":"AssetBucket","path":"KhayaStack/ApiLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.222.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"KhayaStack/ApiLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-615608124862-us-east-1","s3Key":"4ae29b0fd63361d2386e24e8bc1b8451389a151a5c2fba3f3a70b6461e30da59.zip"},"environment":{"variables":{"USERS_TABLE":{"Ref":"UsersTable9725E9C8"},"PROFILES_TABLE":{"Ref":"ProfilesTable3B48B4C6"},"JOBS_TABLE":{"Ref":"JobsTable1970BC16"},"BIDS_TABLE":{"Ref":"BidsTableE1AD1632"},"LISTINGS_TABLE":{"Ref":"ListingsTableCCEBB5D2"},"REVIEWS_TABLE":{"Ref":"ReviewsTable1E51AE49"},"CREDITS_TABLE":{"Ref":"CreditsTable13AC5EA8"},"REFERRALS_TABLE":{"Ref":"ReferralsTable2A6E2E9C"},"STORIES_TABLE":{"Ref":"StoriesTableF145CECC"},"STORAGE_BUCKET":{"Ref":"KhayaStorageBucket6A5AFBEB"},"USER_POOL_ID":{"Ref":"KhayaUserPool64146B1C"},"USER_POOL_CLIENT_ID":{"Ref":"KhayaAppClient7533AECC"}}},"handler":"index.handler","memorySize":512,"reservedConcurrentExecutions":100,"role":{"Fn::GetAtt":["ApiLambdaServiceRole1CC7D0F3","Arn"]},"runtime":"nodejs20.x","timeout":30}}}}},"KhayaAPI":{"id":"KhayaAPI","path":"KhayaStack/KhayaAPI","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/KhayaAPI/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"description":"ProjectKhaya.co.za Marketplace API","name":"Khaya Service API"}}},"CloudWatchRole":{"id":"CloudWatchRole","path":"KhayaStack/KhayaAPI/CloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.222.0","metadata":[]},"children":{"ImportCloudWatchRole":{"id":"ImportCloudWatchRole","path":"KhayaStack/KhayaAPI/CloudWatchRole/ImportCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}},"Resource":{"id":"Resource","path":"KhayaStack/KhayaAPI/CloudWatchRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"apigateway.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"]]}]}}}}},"Account":{"id":"Account","path":"KhayaStack/KhayaAPI/Account","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAccount","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Account","aws:cdk:cloudformation:props":{"cloudWatchRoleArn":{"Fn::GetAtt":["KhayaAPICloudWatchRole62351C48","Arn"]}}}},"Deployment":{"id":"Deployment","path":"KhayaStack/KhayaAPI/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/KhayaAPI/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"ProjectKhaya.co.za Marketplace API","restApiId":{"Ref":"KhayaAPI20285BE5"}}}}}},"DeploymentStage.prod":{"id":"DeploymentStage.prod","path":"KhayaStack/KhayaAPI/DeploymentStage.prod","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/KhayaAPI/DeploymentStage.prod/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"KhayaAPIDeployment64E7A1BC89d0c938de7e956a4daee7d1cd1e3d8d"},"methodSettings":[{"httpMethod":"*","resourcePath":"/*","dataTraceEnabled":false,"throttlingBurstLimit":1000,"throttlingRateLimit":500}],"restApiId":{"Ref":"KhayaAPI20285BE5"},"stageName":"prod"}}}}},"Endpoint":{"id":"Endpoint","path":"KhayaStack/KhayaAPI/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"Default":{"id":"Default","path":"KhayaStack/KhayaAPI/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.222.0","metadata":[]},"children":{"OPTIONS":{"id":"OPTIONS","path":"KhayaStack/KhayaAPI/Default/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/KhayaAPI/Default/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,Authorization'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Fn::GetAtt":["KhayaAPI20285BE5","RootResourceId"]},"restApiId":{"Ref":"KhayaAPI20285BE5"}}}}}},"{proxy+}":{"id":"{proxy+}","path":"KhayaStack/KhayaAPI/Default/{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ProxyResource","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/KhayaAPI/Default/{proxy+}/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["KhayaAPI20285BE5","RootResourceId"]},"pathPart":"{proxy+}","restApiId":{"Ref":"KhayaAPI20285BE5"}}}},"OPTIONS":{"id":"OPTIONS","path":"KhayaStack/KhayaAPI/Default/{proxy+}/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/KhayaAPI/Default/{proxy+}/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,Authorization'","method.response.header.Access-Control-Allow-Origin":"'*'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Access-Control-Allow-Methods":true}}],"resourceId":{"Ref":"KhayaAPIproxy8F14319C"},"restApiId":{"Ref":"KhayaAPI20285BE5"}}}}}},"ANY":{"id":"ANY","path":"KhayaStack/KhayaAPI/Default/{proxy+}/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.222.0","metadata":[]},"children":{"ApiPermission.KhayaStackKhayaAPI722E000F.ANY..{proxy+}":{"id":"ApiPermission.KhayaStackKhayaAPI722E000F.ANY..{proxy+}","path":"KhayaStack/KhayaAPI/Default/{proxy+}/ANY/ApiPermission.KhayaStackKhayaAPI722E000F.ANY..{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["ApiLambda91D2282D","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:615608124862:",{"Ref":"KhayaAPI20285BE5"},"/",{"Ref":"KhayaAPIDeploymentStageprodDCC70FD3"},"/*/*"]]}}}},"ApiPermission.Test.KhayaStackKhayaAPI722E000F.ANY..{proxy+}":{"id":"ApiPermission.Test.KhayaStackKhayaAPI722E000F.ANY..{proxy+}","path":"KhayaStack/KhayaAPI/Default/{proxy+}/ANY/ApiPermission.Test.KhayaStackKhayaAPI722E000F.ANY..{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["ApiLambda91D2282D","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:615608124862:",{"Ref":"KhayaAPI20285BE5"},"/test-invoke-stage/*/*"]]}}}},"Resource":{"id":"Resource","path":"KhayaStack/KhayaAPI/Default/{proxy+}/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["ApiLambda91D2282D","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"KhayaAPIproxy8F14319C"},"restApiId":{"Ref":"KhayaAPI20285BE5"}}}}}}}},"ANY":{"id":"ANY","path":"KhayaStack/KhayaAPI/Default/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/KhayaAPI/Default/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"MOCK"},"resourceId":{"Fn::GetAtt":["KhayaAPI20285BE5","RootResourceId"]},"restApiId":{"Ref":"KhayaAPI20285BE5"}}}}}}}}}},"KhayaFrontendBucket":{"id":"KhayaFrontendBucket","path":"KhayaStack/KhayaFrontendBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/KhayaFrontendBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"publicAccessBlockConfiguration":{"blockPublicAcls":false,"blockPublicPolicy":false,"ignorePublicAcls":false,"restrictPublicBuckets":false},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}],"websiteConfiguration":{"indexDocument":"index.html","errorDocument":"index.html"}}}},"Policy":{"id":"Policy","path":"KhayaStack/KhayaFrontendBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/KhayaFrontendBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"KhayaFrontendBucket73A25EBF"},"policyDocument":{"Statement":[{"Action":"s3:GetObject","Effect":"Allow","Principal":{"AWS":"*"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["KhayaFrontendBucket73A25EBF","Arn"]},"/*"]]}},{"Action":["s3:PutBucketPolicy","s3:GetBucket*","s3:List*","s3:DeleteObject*"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["KhayaFrontendBucket73A25EBF","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["KhayaFrontendBucket73A25EBF","Arn"]},"/*"]]}]},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OAIE1EFC67F","S3CanonicalUserId"]}},"Resource":[{"Fn::GetAtt":["KhayaFrontendBucket73A25EBF","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["KhayaFrontendBucket73A25EBF","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"KhayaStack/KhayaFrontendBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.222.0","metadata":[]},"children":{"Default":{"id":"Default","path":"KhayaStack/KhayaFrontendBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.222.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"KhayaStack/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.222.0"},"children":{"Staging":{"id":"Staging","path":"KhayaStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.222.0"}},"Role":{"id":"Role","path":"KhayaStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.222.0"}},"Handler":{"id":"Handler","path":"KhayaStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.222.0"}}}},"OAI":{"id":"OAI","path":"KhayaStack/OAI","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.OriginAccessIdentity","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/OAI/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnCloudFrontOriginAccessIdentity","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::CloudFrontOriginAccessIdentity","aws:cdk:cloudformation:props":{"cloudFrontOriginAccessIdentityConfig":{"comment":"OAI for Khaya frontend bucket"}}}}}},"KhayaCDN":{"id":"KhayaCDN","path":"KhayaStack/KhayaCDN","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Distribution","version":"2.222.0","metadata":[]},"children":{"Origin1":{"id":"Origin1","path":"KhayaStack/KhayaCDN/Origin1","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"}},"Origin2":{"id":"Origin2","path":"KhayaStack/KhayaCDN/Origin2","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"}},"Resource":{"id":"Resource","path":"KhayaStack/KhayaCDN/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"enabled":true,"origins":[{"domainName":{"Fn::Select":[2,{"Fn::Split":["/",{"Fn::GetAtt":["KhayaFrontendBucket73A25EBF","WebsiteURL"]}]}]},"id":"KhayaStackKhayaCDNOrigin13CB54D1D","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"http-only"}},{"domainName":{"Fn::Select":[2,{"Fn::Split":["/",{"Fn::Join":["",["https://",{"Ref":"KhayaAPI20285BE5"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"},"/",{"Ref":"KhayaAPIDeploymentStageprodDCC70FD3"},"/"]]}]}]},"id":"KhayaStackKhayaCDNOrigin295A32F0B","originPath":{"Fn::Join":["",["/",{"Fn::Select":[3,{"Fn::Split":["/",{"Fn::Join":["",["https://",{"Ref":"KhayaAPI20285BE5"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"},"/",{"Ref":"KhayaAPIDeploymentStageprodDCC70FD3"},"/"]]}]}]}]]},"customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"https-only"}}],"defaultCacheBehavior":{"pathPattern":"*","targetOriginId":"KhayaStackKhayaCDNOrigin13CB54D1D","allowedMethods":["GET","HEAD","OPTIONS"],"cachedMethods":["GET","HEAD","OPTIONS"],"cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6","compress":true,"viewerProtocolPolicy":"redirect-to-https"},"cacheBehaviors":[{"pathPattern":"/api/*","targetOriginId":"KhayaStackKhayaCDNOrigin295A32F0B","allowedMethods":["GET","HEAD","OPTIONS","PUT","PATCH","POST","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","compress":true,"originRequestPolicyId":"216adef6-5c7f-47e4-b989-5492eafa07d3","viewerProtocolPolicy":"https-only"}],"customErrorResponses":[{"errorCachingMinTtl":300,"errorCode":404,"responseCode":200,"responsePagePath":"/index.html"},{"errorCachingMinTtl":300,"errorCode":403,"responseCode":200,"responsePagePath":"/index.html"}],"defaultRootObject":"index.html","httpVersion":"http2and3","ipv6Enabled":true,"priceClass":"PriceClass_100"}}}}}},"DailyTasksLambda":{"id":"DailyTasksLambda","path":"KhayaStack/DailyTasksLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.222.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"KhayaStack/DailyTasksLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.222.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"KhayaStack/DailyTasksLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.222.0","metadata":[]}},"Resource":{"id":"Resource","path":"KhayaStack/DailyTasksLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"KhayaStack/DailyTasksLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/DailyTasksLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["JobsTable1970BC16","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["JobsTable1970BC16","Arn"]},"/index/*"]]}]},{"Action":["dynamodb:BatchGetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:Query","dynamodb:GetItem","dynamodb:Scan","dynamodb:ConditionCheckItem","dynamodb:BatchWriteItem","dynamodb:PutItem","dynamodb:UpdateItem","dynamodb:DeleteItem","dynamodb:DescribeTable"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ListingsTableCCEBB5D2","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ListingsTableCCEBB5D2","Arn"]},"/index/*"]]}]}],"Version":"2012-10-17"},"policyName":"DailyTasksLambdaServiceRoleDefaultPolicyEB203DBA","roles":[{"Ref":"DailyTasksLambdaServiceRole2D874A07"}]}}}}}}},"Code":{"id":"Code","path":"KhayaStack/DailyTasksLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.222.0"},"children":{"Stage":{"id":"Stage","path":"KhayaStack/DailyTasksLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.222.0"}},"AssetBucket":{"id":"AssetBucket","path":"KhayaStack/DailyTasksLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.222.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"KhayaStack/DailyTasksLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-615608124862-us-east-1","s3Key":"4ae29b0fd63361d2386e24e8bc1b8451389a151a5c2fba3f3a70b6461e30da59.zip"},"environment":{"variables":{"JOBS_TABLE":{"Ref":"JobsTable1970BC16"},"LISTINGS_TABLE":{"Ref":"ListingsTableCCEBB5D2"}}},"handler":"daily.handler","role":{"Fn::GetAtt":["DailyTasksLambdaServiceRole2D874A07","Arn"]},"runtime":"nodejs20.x","timeout":300}}}}},"DailyTasksRule":{"id":"DailyTasksRule","path":"KhayaStack/DailyTasksRule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.222.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"KhayaStack/DailyTasksRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"description":"Run daily maintenance tasks","scheduleExpression":"rate(1 day)","state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["DailyTasksLambda5FE227E9","Arn"]}}]}}},"AllowEventRuleKhayaStackDailyTasksLambda7F9034AC":{"id":"AllowEventRuleKhayaStackDailyTasksLambda7F9034AC","path":"KhayaStack/DailyTasksRule/AllowEventRuleKhayaStackDailyTasksLambda7F9034AC","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.222.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["DailyTasksLambda5FE227E9","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["DailyTasksRuleC088F1C1","Arn"]}}}}}},"APIUrl":{"id":"APIUrl","path":"KhayaStack/APIUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"CDNUrl":{"id":"CDNUrl","path":"KhayaStack/CDNUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"DistributionId":{"id":"DistributionId","path":"KhayaStack/DistributionId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"UserPoolId":{"id":"UserPoolId","path":"KhayaStack/UserPoolId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"UserPoolClientId":{"id":"UserPoolClientId","path":"KhayaStack/UserPoolClientId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"FrontendBucket":{"id":"FrontendBucket","path":"KhayaStack/FrontendBucket","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"StorageBucket":{"id":"StorageBucket","path":"KhayaStack/StorageBucket","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.222.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"KhayaStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"},"children":{"Default":{"id":"Default","path":"KhayaStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.222.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"KhayaStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.222.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"KhayaStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.222.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.3"}}}}}